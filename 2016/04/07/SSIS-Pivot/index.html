<!DOCTYPE html><html lang="zh-Hans"><head><!--[if lt IE 9]><style>body {display: none; background: none !important} </style><meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/"/><![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="c-xuan"><meta name="description" content="问题引入有如下格式的文件，需要转换成如图二的格式导入数据库里，这就是所谓的列传行的格式，是一种逆透视的操作。用Excel透视操作或者写个VBA宏程序是可以实现的，我们现在用SSIS的逆透视组件来实现下。"><meta property="og:type" content="article"><meta property="og:title" content="【SSIS】进行列转行格式的转换"><meta property="og:url" content="https://c-xuan.com/2016/04/07/SSIS-Pivot/index.html"><meta property="og:site_name" content="靛青"><meta property="og:description" content="问题引入有如下格式的文件，需要转换成如图二的格式导入数据库里，这就是所谓的列传行的格式，是一种逆透视的操作。用Excel透视操作或者写个VBA宏程序是可以实现的，我们现在用SSIS的逆透视组件来实现下。"><meta property="og:image" content="https://c-xuan.com/img/posts/48.png"><meta property="og:image" content="https://c-xuan.com/img/posts/49.png"><meta property="og:image" content="https://c-xuan.com/img/posts/50.png"><meta property="og:image" content="https://c-xuan.com/img/posts/51.png"><meta property="og:image" content="https://c-xuan.com/img/posts/52.png"><meta property="og:image" content="https://c-xuan.com/img/posts/53.png"><meta property="og:image" content="https://c-xuan.com/img/posts/54.png"><meta property="og:image" content="https://c-xuan.com/img/posts/55.png"><meta property="og:image" content="https://c-xuan.com/img/posts/56.png"><meta property="og:image" content="https://c-xuan.com/img/posts/57.png"><meta property="og:image" content="https://c-xuan.com/img/posts/58.png"><meta property="og:image" content="https://c-xuan.com/img/posts/59.png"><meta property="og:image" content="https://c-xuan.com/img/posts/60.png"><meta property="og:image" content="https://c-xuan.com/img/posts/61.png"><meta property="og:image" content="https://c-xuan.com/img/posts/62.png"><meta property="og:image" content="https://c-xuan.com/img/posts/63.png"><meta property="og:image" content="https://c-xuan.com/img/posts/64.png"><meta property="og:image" content="https://c-xuan.com/img/posts/65.png"><meta property="og:updated_time" content="2016-09-25T12:21:52.607Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="【SSIS】进行列转行格式的转换"><meta name="twitter:description" content="问题引入有如下格式的文件，需要转换成如图二的格式导入数据库里，这就是所谓的列传行的格式，是一种逆透视的操作。用Excel透视操作或者写个VBA宏程序是可以实现的，我们现在用SSIS的逆透视组件来实现下。"><meta name="twitter:image" content="https://c-xuan.com/img/posts/48.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="alternate" href="/atom.xml" title="靛青" type="application/atom+xml"><link rel="shortcut icon" href="/favicon.png"><link href="/js/others/animate.css" rel="stylesheet"><link href="/js/others/jquery.fancybox.min.css" rel="stylesheet"><script src="/js/others/pace.min.js"></script><link href="/js/others/pace-theme-minimal.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><link href="/js/others/font-awesome.min.css" rel="stylesheet"><title>【SSIS】进行列转行格式的转换 | 靛青</title><script src="/js/others/jquery.min.js"></script><script src="/js/others/clipboard.min.js"></script><script type="text/javascript" src="/js/love.js"></script><script>var yiliaConfig={fancybox:!0,animate:!0,isHome:!1,isPost:!0,isArchive:!1,isTag:!1,isCategory:!1,fancybox_js:"/js/others/jquery.fancybox.min.js",scrollreveal:"/js/others/scrollreveal.min.js",search:!0,jquery_ui:[!0,"/js/others/jquery-ui.min.js","/js/others/jquery-ui.min.css"],rootUrl:"/"}</script><script>var isIgnoreHost=!1;if(window&&window.location&&window.location.host){var isIgnoreHostList="localhost/127.0.0.1",hostArray=isIgnoreHostList.split("/");for(x in hostArray)if(isIgnoreHost=0===window.location.host.indexOf(hostArray[x]))break}var _hmt=_hmt||[];isIgnoreHost||(function(){var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?04b5ef87eb2ec9589e8227fcc877686b";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(t,o)}(),function(){var t=document.createElement("script"),o=window.location.protocol.split(":")[0];t.src="https"===o?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}())</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111421027-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-111421027-1")</script></head><body><div id="container"><div class="left-col"><form id="search-form"> <input type="text" id="local-search-input" name="q" placeholder="搜索本站..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false"></form><div id="local-search-result"></div><p class="no-result">No results found<i class="fa fa-spinner fa-pulse"></i></p><div class="intrude-less"><header id="header" class="inner"> <a href="/" class="profilepic"><img src="/img/cxuan.png" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/" data-hover="靛青">靛青</a></h1></hgroup><p class="header-subtitle">青，取之于藍而青于藍。</p><div id="switch-btn" class="switch-btn"><div class="icon"><div class="icon-ctn"><div class="icon-wrap icon-house" data-idx="0"><div class="birdhouse"></div><div class="birdhouse_holes"></div></div><div class="icon-wrap icon-ribbon hide" data-idx="1"><div class="ribbon"></div></div><div class="icon-wrap icon-link hide" data-idx="2"><div class="loopback_l"></div><div class="loopback_r"></div></div><div class="icon-wrap icon-me hide" data-idx="3"><div class="user"></div><div class="shoulder"></div></div></div></div><div class="tips-box hide"><div class="tips-arrow"></div><ul class="tips-inner"><li>菜单</li><li>标签</li><li>友情链接</li><li>关于我</li></ul></div></div><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="/" data-hover="主页">主页</a></li><li><a href="/archives/" data-hover="所有文章">所有文章</a></li><li><a href="/tags/" data-hover="标签云">标签云</a></li><li><a href="/whis/" data-hover="折腾史">折腾史</a></li><li><a href="/about/" data-hover="关于我">关于我</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" href="mailto:c-xuan@foxmail.com" title="Email"></a><a class="fa 新浪微博" href="http://weibo.com/u/1794820305" title="新浪微博"></a> <a class="fa GitHub" href="https://github.com/cxuan" title="GitHub"><svg height="37" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="37" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a><a class="fa 简书" href="http://www.jianshu.com/users/2e80e903099c/latest_articles" title="简书"></a><a class="fa RSS" href="/atom.xml" title="RSS"></a></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id="js-tagcloud"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Atom/">Atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BI/">BI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BigData/">BigData</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ETL/">ETL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flask/">Flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hbase/">Hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/">Hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IT资讯/">IT资讯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JScript/">JScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MSBI/">MSBI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ORACLE/">ORACLE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PDI/">PDI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Play-Framework/">Play Framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostgreSQL/">PostgreSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL-Server/">SQL Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSIS/">SSIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/">Test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/atom/">atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmd/">cmd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kettle/">kettle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pentaho/">pentaho</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端编程/">前端编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原创/">原创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源/">开源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学/">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据仓库/">数据仓库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/物化视图/">物化视图</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生活趣记/">生活趣记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/知识管理/">知识管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/维度建模/">维度建模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻译/">翻译</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/视觉图片/">视觉图片</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机基原理/">计算机基原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计/">设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/转载/">转载</a></li></ul></div></section><section class="switch-part switch-part3"><div id="js-friends"> <a class="main-nav-link switch-friends-link" href="http://opiece.me/">Chillax&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="https://ask.hellobi.com/blog/biwork">BIWORK</a> <a class="main-nav-link switch-friends-link" href="http://blog.iwangyu.cn/">Wang Yu&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="http://www.domeyi.com/">小忆</a> <a class="main-nav-link switch-friends-link" href="https://www.sfantree.com/">水番林</a> <a class="main-nav-link switch-friends-link" href="http://www.netcan666.com/">Netcan</a> <a class="main-nav-link switch-friends-link" href="http://www.ykksmile.top/">Ykk</a> <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a> <a class="main-nav-link switch-friends-link" href="http://luuman.github.io/">世平阜康</a> <a class="main-nav-link switch-friends-link" href="http://www.blog67.cn/">67&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="http://hubojing.github.io/">胡博靖</a> <a class="main-nav-link switch-friends-link" href="https://deserts.io">Deserts</a> <a class="main-nav-link switch-friends-link" href="https://www.liyebk.com">李野博客</a> <a class="main-nav-link switch-friends-link" href="https://xlesun.com/">Lesun&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="http://blog.codinglabs.org/">CodingLabs</a></div></section><section class="switch-part switch-part4"><div id="js-aboutme">专注于DW&amp;BI</div></section></div></div></header></div><footer id="left-col-footer"><div class="footer-center"><i class="fa fa-copyright"></i> 2016-2019 c-xuan</div></footer></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">c-xuan</a></h1></div><div class="intrude-less"><header id="header" class="inner"> <a href="/" class="profilepic" width="20%"><img src="/img/cxuan.png" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/" title="回到主页">靛青</a></h1></hgroup><p class="header-subtitle">青，取之于藍而青于藍。</p><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/whis/">折腾史</a></li><li><a href="/about/">关于我</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" target="_blank" href="mailto:c-xuan@foxmail.com" title="Email"></a><a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/1794820305" title="新浪微博"></a> <a class="fa GitHub" target="_blank" href="https://github.com/cxuan" title="GitHub"><svg height="37" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="37" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a><a class="fa 简书" target="_blank" href="http://www.jianshu.com/users/2e80e903099c/latest_articles" title="简书"></a><a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a></ul></nav></header></div><link class="menu-list" tags="标签" friends="友情链接" about="关于我"></nav><div class="body-wrap"><article id="post-SSIS-Pivot" class="article article-type-post animated pulse" itemscope itemprop="blogPost"><div class="article-meta"> <a href="/2016/04/07/SSIS-Pivot/" class="article-date"><time datetime="2016-04-06T16:00:00.000Z" itemprop="datePublished">2016-04-07</time></a></div><div class="article-inner"> <input type="hidden" class="isFancy"><header class="article-header"><h1 class="article-title" itemprop="name"> 【SSIS】进行列转行格式的转换</h1></header><div class="article-info article-info-post"><div class="article-category tagcloud"> <a class="article-category-link" href="/categories/BI墨客/">BI墨客</a></div><div class="article-tag tagcloud"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BI/">BI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSIS/">SSIS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原创/">原创</a></li></ul></div><div style="font-size:.9rem;color:#696969;line-height:2">　　<i class="fa fa-pencil-square-o" aria-hidden="true"></i> 本文字数<span class="post-count">944</span> |<i class="fa fa-clock-o" aria-hidden="true"></i> 阅读时长约<span class="post-count">3</span>分钟</div><div class="clearfix"></div></div><div class="article-entry" itemprop="articleBody"><h2 id="问题引入"><a href="#问题引入" class="headerlink" title="问题引入"></a>问题引入</h2><p>有如下格式的文件，需要转换成如图二的格式导入数据库里，这就是所谓的列传行的格式，是一种逆透视的操作。用Excel透视操作或者写个VBA宏程序是可以实现的，我们现在用SSIS的逆透视组件来实现下。</p><a id="more"></a><p><img src="/img/posts/48.png" alt="行格式"></p><p><img src="/img/posts/49.png" alt="列格式"></p><h2 id="系统环境"><a href="#系统环境" class="headerlink" title="系统环境"></a>系统环境</h2><ul><li>Windows 7</li><li>SQL Server 2008 R2</li><li>Business Intelligence Development Studio</li></ul><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>首先废话不多说，新建SSIS项目</p><p><img src="/img/posts/50.png" alt="新建SSIS项目"></p><p>拖入EXCEL数据源，选择源文件。</p><p><img src="/img/posts/51.png" alt="拖入EXCEL数据源"></p><p>拖入逆透视组件</p><p><img src="/img/posts/52.png" alt="逆透视组件"></p><p><img src="/img/posts/53.png" alt="逆透视编辑器"></p><p>打开逆透视编辑器，这里有几个说明的地方：</p><ul><li>1.可用输入列里面的传递，如果勾上了，这一列将不进行逆透视，就是直接输出到目标文件或者数据库里。</li><li>2.可用输入列里左边的复选框勾上就是需要将这列进行逆透视的操作，勾选后将会出现在下面。</li><li>3.下面目标列里默认是空的，需要自己填，这一列的值将会是源文件1号到31号每一列里的金额值，所以目标列填的都一样，略坑的是需要一个一个填，我复制黏贴了30遍。</li><li>4.透视键值列名最好改个名称，就是输入列逆透视后放在那一列下面，这里填的就是列名，1号到31号将会作为“几号”列下面的值。</li></ul><p>其他默认，按确定。确认完了，发现有错误。提示：</p><blockquote><p>数据流任务 [逆透视 [116]] 出错: UnPivot 元数据不正确。在 UnPivot 转换中，对于所有设置了 PivotKeyValue 且指向相同 DestinationColumn 的输入列，其元数据都必须与 DestinationColumn 完全匹配。</p></blockquote><p><img src="/img/posts/54.png" alt="报错"></p><p>这是啥问题，折腾了一点时间，在逆透视组件的高级编辑器了怎么调都不好使。仔细看了下，会不会是数据类型的问题，果然，逆透视列的数据类型不是都一样的，所以就添加了一个数据转换组件。</p><p><img src="/img/posts/55.png" alt="数据类型"></p><p><img src="/img/posts/56.png" alt="数据类型"></p><p><img src="/img/posts/57.png" alt="数据类型转换"></p><p>在数据转换组件里把字符串类型都转成浮点型数据。</p><p><img src="/img/posts/58.png" alt="逆透视编辑器"></p><p>最好把之前的那个逆透视的组件删了，重新建一个。把逆透视的列改成类型转换的输出列，目标列又复制黏贴了30次。</p><p>这样逆透视的组件就不会报错了，然后执行下数据流，哟，报错了，提示一个或多个组件未能通过验证。</p><p><img src="/img/posts/59.png" alt="再次报错"></p><p>噢，才想起来项目属性里有一个调试设置什么64位运行环境的要改成false才可以。</p><p><img src="/img/posts/60.png" alt="项目属性"></p><p>这样就不会报错了。</p><p><img src="/img/posts/61.png" alt="顺利执行"></p><p>拖入EXCEL目标组件，列与逆透视组件输出列对应，目标EXCEL是有表头的。</p><p><img src="/img/posts/62.png" alt="EXCEL目标组件"></p><p>转换初见成果啊，但是看着有点不爽，想把年月跟几号列合成一个日期列，日期格式是20160406这种的，在目标表里加入一个日期列。</p><p><img src="/img/posts/63.png" alt="写入Excel文件"></p><p>拖入一个派生列组件，在派生列编辑器里增加一列派生列，表达式如下，就是对字符串的截取拼接，这里就不解释了，然后在Excel目标里给这个派生列映射到目标表的“日期”。</p><pre><code>(DT_WSTR,6)[年月] + RIGHT(&quot;0&quot; + SUBSTRING([几号],1,FINDSTRING([几号],&quot;日&quot;,1) - 1),2)
</code></pre><p><img src="/img/posts/64.png" alt="派生列"></p><p>重新执行下数据流，嗯，达到目的。</p><p><img src="/img/posts/65.png" alt="执行成功"></p><h2 id="总结一下"><a href="#总结一下" class="headerlink" title="总结一下"></a>总结一下</h2><ul><li>在使用处理数据列的组件之前最好加一个数据类型转换的组件，看看有哪些数据类型是不符合我们预期的。</li><li>项目属性里的调试64位运行时不知道啥情况，为TRUE时会报错，得设置为FASLE。</li><li>逆透视组件设置相对简单，找好逆透视的列以及行数据要放在哪列里就可以了。</li></ul></div></div><div class="copyright"><p><span>本文标题:</span><a href="/2016/04/07/SSIS-Pivot/">【SSIS】进行列转行格式的转换</a></p><p><span>文章作者:</span><a href="/" title="回到主页">c-xuan</a></p><p><span>发布时间:</span>2016-04-07, 00:00:00</p><p><span>最后更新:</span>2016-09-25, 20:21:52</p><p> <span>原始链接:</span><a class="post-url" href="/2016/04/07/SSIS-Pivot/" title="【SSIS】进行列转行格式的转换">https://c-xuan.com/2016/04/07/SSIS-Pivot/</a><span class="copy-path" data-clipboard-text="原文: https://c-xuan.com/2016/04/07/SSIS-Pivot/　　作者: c-xuan" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span><script>var clipboard=new Clipboard(".copy-path")</script></p><p> <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。</p></div><nav id="article-nav"><div id="article-nav-newer" class="article-nav-title"> <a href="/2016/04/24/SQL-Server-2014-SSDT-Install/">SQL Server 2014的BI开发工具SSDT(以前的BIDS)安装</a></div><div id="article-nav-older" class="article-nav-title"> <a href="/2016/03/27/AppleTV-Poster-Like/">用CSS3 &amp; jQuery创建apple TV海报视差效果</a></div></nav><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏"></a> <span class="donate_txt">↑<br> 有所帮助？赏包辣条！</span><br></div><div id="donate_guide" class="donate_bar center hidden animated bounceIn"> <img src="/img/Alipay.png" alt="支付宝打赏"> <img src="/img/WeChatpay.png" alt="微信打赏"></div><script type="text/javascript">document.getElementById("btn_donate").onclick=function(){$("#donate_board").addClass("hidden"),$("#donate_guide").removeClass("hidden")}</script></div></article><div id="toc" class="toc-article"> <strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#问题引入"><span class="toc-number">1.</span> <span class="toc-text">问题引入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#系统环境"><span class="toc-number">2.</span> <span class="toc-text">系统环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#步骤"><span class="toc-number">3.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结一下"><span class="toc-number">4.</span> <span class="toc-text">总结一下</span></a></li></ol></div><style>.left-col .switch-area,.left-col .switch-btn{display:none}.toc-level-4 i,.toc-level-4 ol{display:none!important}</style> <input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录"><script>yiliaConfig.toc=["隐藏目录","显示目录",!0]</script><div class="share"><script>with(window._bd_share_config={common:{bdSnsKey:{},bdText:"",bdMini:"2",bdMiniList:!1,bdPic:"",bdStyle:"0",bdSize:"16"},slide:{type:"slide",bdImg:"6",bdPos:"right",bdTop:"100"},image:{viewList:["qzone","tsina","weixin","youdao","fbook","twi"],viewText:"分享到：",viewSize:"16"},selectShare:{bdContainerClass:null,bdSelectMiniList:["qzone","tsina","weixin","youdao","fbook","twi"]}},document)(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)</script></div><section id="comments" class="valine" style="width:85%;margin:0 auto;background:rgba(255,255,255,.7);padding:1% 1% 0 1%;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px"><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var notify=!1,verify=!1;if(new Valine({av:AV,el:"#vcomment",notify:notify,verify:verify,app_id:"wKQ5QBjSGMEviU0fVawpBJo0-gzGzoHsz",app_key:"1zPWBxCFNb0UPr85TMeCNLOK",placeholder:"说点什么吧... ps:昵称/邮箱/网址都可以选填哦",avatar:"wavatar",avatar_cdn:"https://sdn.geekzu.org/avatar/",pageSize:20,meta:["nick","mail","link"]}),window.location.hash)var checkExist=setInterval(function(){$(window.location.hash).length&&($("html, body").animate({scrollTop:$(window.location.hash).offset().top-90},1e3),clearInterval(checkExist))},100)</script></section><div class="scroll" id="post-nav-button"><a href="/2016/04/24/SQL-Server-2014-SSDT-Install/" title="上一篇: SQL Server 2014的BI开发工具SSDT(以前的BIDS)安装"><i class="fa fa-angle-left"></i></a><a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a><a href="/2016/03/27/AppleTV-Poster-Like/" title="下一篇: 用CSS3 &amp; jQuery创建apple TV海报视差效果"><i class="fa fa-angle-right"></i></a></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/03/27/20190327001_pdi_case/">PDI设计转换任务</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/26/20190326001_python_datetime/">Python日期时间操作总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/13/20190313001_python_dict/">【Python 3 基础】字典dict创建方法及常用操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/05/20190305001_css_parallax_effects/">CSS视差效果设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/21/20190221001_nteract/">类Jupyter notebook编辑器桌面版nteract</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/20/20190220002_atom_atuo_err/">【Atom】autocomplete-python插件报乱码异常问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/20/20190220001_py_list_merge/">Python多个数组合并</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/18/20190218001_hydrogen_venv/">Atom编辑器中使用Hydrogen切换Python虚拟环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/14/20190214001_product_card/">【Web前端】11个使用CSS制作产品展示卡片样例</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/07/20190207001_css_water_effects/">CSS制作水滴效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/15/20190115001_python_db_select_to_df/">Python连接数据库将查询结果转换为DataFrame(列名和表字段一致)</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/04/20190104001_graph_sql/">SQL如何实现查找节点依赖</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/23/20181223001_flask_intranet_visit/">Flask服务本机之外不能访问</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/21/20181221001_atom_aligner/">Atom插件aligner冒号(:)对齐的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/24/20181124001_css_fire/">Html中使用CSS制作火焰燃烧动画</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/18/20181118001_403_pages/">有趣的403页面设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/14/20181114001_404_pages/">有趣的404页面设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/13/20180813001_py_clousure/">理解Python函数闭包</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/26/20180726001_aqua_hive_go/">Aqua Data Studio 执行HiveSql的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/24/20180724001_hive_date_trans/">【Hive】日期从整形转为Date类型</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/02/20180602001_jscript/">有用的JScript代码整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/26/20180126001/">【Python 3 基础】循环</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/24/20180124001/">CentOS Hbase-1.2.0 安装配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/20/20180120001/">CentOS上zookeeper集群模式安装配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/10/20171210001/">Markdown使用table标签创建表格的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/28/20171128001/">【cmd】IF ELSE 复制(copy)文件问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/19/20171119001/">【ORACLE】导致物化视图快速刷新变慢的原因和解决</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/15/20170815001/">【ORACLE】常用物化视图相关元数据查询语句</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/13/20170813001/">【ORACLE】物化视图相关元数据视图字段说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/13/20170713001/">【ORACLE】物化视图快速刷新限制条件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/07/tree-table-store5/">树形结构数据存储方案（五）：区间嵌套</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/07/tree-table-store4/">树形结构数据存储方案（四）：左右值编码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/06/tree-table-store3/">树形结构数据存储方案（三）：闭包表</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/06/tree-table-store2/">树形结构数据存储方案（二）： 物化路径</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/06/tree-table-store1/">树型结构数据存储方案（一）：邻接列表模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/05/KimballDimModing/">Kimball维度建模技术总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/wide-table-thinking/">宽表和窄表的建设该如何选择？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/02/SQLAddColumnNote/">【SQL Server】编辑、修改字段说明（备注）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/BenifitOfWritingBlog/">从事技术，坚持写博客的好处？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/HardSayGoodby/">再见Solo，谢谢!</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/29/JS-BuildBaseClassLib/">JavaScript :零基础打造自己的类库</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/WhyDifficultOnETLJob/">为什么ETL任务困难</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/DecisionThoughtOnBigdata/">从大数据负责人招聘看决策思维</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/08/TimeForPKM/">是时候管理你的知识了</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/21/NoWeChatBefore/">那些年，我们没有微信</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/21/PlayFrameworkInit2/">Play Framework 2.5 环境搭建与新建项目（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/20/PlayFrameworkInit/">Play Framework 2.5 环境搭建与新建项目（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/17/PCProblemRightKeyItem/">电脑右键菜单中没有新建和在此处打开命令行选项的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/12/ConstraintNameUniquenessProblem/">【PowerDesigner】Constraint name uniqueness问题及处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/21RulesForDataWarehousing/">数据仓库设计的7个步骤，7个禁忌和7种思路</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/SSISCodePageProblem/">SSIS中代码页(Code Page)问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/26/DataWarehouseSchemeCompare/">深入对比数据仓库模式：Kimball vs Inmon</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Datawarehouse-10Dimension-principle/">数据仓库维度建模10大基本原则</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/20/MarkDown教程/">Markdown教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/29/Foumula-TOP10/">改变世界的公式TOP10,最后一个一看就蒙圈了</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/13/SSIS-GeneralAttribures/">【SSIS】几个通用属性</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/13/SQL-GroupByAndGroupingSets/">【T-SQL】group by 和grouping sets</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/05/BuildBusinessOrientedBigDataCloudPlatform/">放开那程序猿！构建业务导向的大数据云平台</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/05/RealEstateBISolutionCaseShare/">房地产行业商业智能解决方案分享</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/27/SQL-SERVER-RPC-FUNCTION-CALL/">【SQL SERVER】OPENQUERY远程函数引用及参数传值问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/26/Linked-Server-RPC/">【SQL SERVER】链接数据库“无法启动分布式事务”的问题及解决</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/25/30-Astonishing-Nature-Places-on-Earth/">令人惊叹的30个自然奇观</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/22/JS-AddIn-PPTSlideEffect/">JS插件:类似PPT翻页过渡动画效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/21/SSIS-Precedence-Constraint/">【SSIS】中Precedence Constraint 优先约束的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/16/SSIS-XMLTask-ProcessArrays/">【SSIS】中Foreach循环容器处理XML数据</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/15/SSIS-Web-Service/">【SSIS】使用 Web Service 以及 解析XML 数据</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/06/SSIS-Template-For-SSISPackage/">【SSIS】利用SSIS模板快速开发SSIS Package</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/06/The-Art-of-Computer-Programming/">比尔·盖茨：如果你看完了这些极其难懂的书，请给我投简历！</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/26/codepen-top-10/">CodePen上碉堡的前端设计和代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/26/Delete-duplicate-rows-with-no-primary-key/">如何在没有主键的SQL Server表里删除重复行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/CSS3-transform-style-3D-Cool/">学习制作CSS3 3D旋转透视效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/SQL-Server-2014-SSDT-Install/">SQL Server 2014的BI开发工具SSDT(以前的BIDS)安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/07/SSIS-Pivot/">【SSIS】进行列转行格式的转换</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/27/AppleTV-Poster-Like/">用CSS3 & jQuery创建apple TV海报视差效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/17JqueryTips/">17个jQuery实用技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/IconForEveryday/">365cons：每天一枚图标，可免费下载</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/YouDaoNoteMarkdownSupport/">有道笔记支持Markdown啦</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/19/CSS-For-Flip-Effect/">用CSS创建翻转动画</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/17/Web-Cloud-Effect/">Web蓝天白云的极致体验</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/15/CSS-3D-Cloud/">怎样用CSS做出3D效果的云</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/13/SQL-Merge/">SQL强大的关键字Merge</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/12/AlphaGo/">关于李世石大战AlphaGo，看这一篇就足够了</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/09/Paper-Folding/">18种折纸，一起来怀念小时候吧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/08/pentaho6-install/">Pentaho 6.0 安装与启动教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/03/hello-world/">Hello World</a></li></ul><script></script></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left"> <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span></div><div class="footer-right"> Based on <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a> Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a></div></div><div class="visit"><span id="busuanzi_container_site_pv" style="display:none"><span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span></span></span> <span>|</span><span id="busuanzi_container_page_pv" style="display:none"><span id="page-visit" title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span></span></span></div></div></footer><script>var now=new Date;function createtime(){var n=new Date("2016-08-20 04:18:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="运行"+dnum+"天",document.getElementById("times").innerHTML=hnum+"时"+mnum+"分"+snum+"秒"}setInterval("createtime()",250)</script></div><script data-main="/js/main.js" src="/js/others/require.min.js"></script><script>$(document).ready(function(){if(-1<window.navigator.userAgent.indexOf("iPad")||"none"===$(".left-col").css("display")){var a=["#9db3f4","#414141","#e5a859","#f5dfc6","#c084a0","#847e72","#cd8390","#996731"],c=Math.ceil(Math.random()*(a.length-1));$("body").css({"background-color":a[c],"background-size":"cover"})}else{var e="url(/background/bg-x.jpg)".replace(/x/gi,Math.ceil(2*Math.random()));$("body").css({background:e,"background-attachment":"fixed","background-size":"cover"})}})</script><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-111421027-1","auto"),ga("send","pageview")</script><div class="scroll" id="scroll"><a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a><a href="#comments" onclick="load$hide()" title="查看评论"><i class="fa fa-comments-o"></i></a><a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a></div><script>var oOpenInNew={archives:".archive-article-title",miniArchives:"a.post-list-link",friends:"#js-friends a",socail:".social a"};for(var x in oOpenInNew)$(oOpenInNew[x]).attr("target","_blank")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/izumi.model.json"},display:{superSample:1,width:150,height:300,position:"right",hOffset:0,vOffset:-20},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.8},log:!1})</script></body></html>