window._bd_share_main.F.module("trans/trans_weixin",function(i,n){var a,r,d,e="bdshare_weixin_qrcode_dialog",t="",p=0,c={},s=i("base/tangram").T,u=(i("conf/const").URLS,function(i){var e=Math.round(200/i.length),o=['<table style="direction:ltr;border: 0; width:'+(p=(e=e<2?2:e)*i.length)+'px; border-collapse: collapse;background-color:#fff;margin:0 auto;" align="center">'],d="";return s.each(i,function(i,n){o.push("<tr>"),s.each(n,function(i,n){d='<td style="width:'+e+"px;height:"+e+"px;padding:0;margin:0;border:none;background:#"+(n?"000":"FFF")+'"></td>',o.push(d)})}),o.push("</table>"),o.join("")}),_=function(i){var n=(220<i?i:220)+20,e=s(".bd_weixin_popup_foot").height()+s(".bd_weixin_popup_head").height()+i+30;a.css({width:n,height:e})},h=function(){var i=s(window).scrollTop(),n=a.outerWidth(),e=a.outerHeight(),o=s(window).width(),d=(s(window).height()-e)/2+i,t=(o-n)/2;d=d<0?0:d,t=t<0?0:t,r.width(n).height(e).css({left:t,top:d}),a.css({left:t,top:d})},l=function(){a.hide(),r.hide()};n.run=function(i){t=function(i){i=function(i){var n="10006-weixin-1-52626-6b3bffd01fdde4900130bc5a2751b6d1";if("off"===c.sign)return i;if("normal"!==c.sign)return i.replace(/#.*$/g,"")+"#"+n;var e=i.indexOf("#"),o=i.indexOf("?");return-1==e?i+(-1==o?"?":"&")+n:i.replace("#",(-1==o?"?":"&")+n+"#")}(i);var e=[];return s.each(i,function(i,n){/[^\x00-\xff]/.test(n)?e[i]=encodeURI(n):e[i]=n}),e.join("")}((c=i).url),window._bd_share_main.F.use("weixin_popup.css",function(){var o;window._bd_share_main.F.use("component/pop_dialog",function(i){i.Dialog.hide()}),function(){if(a=s("#"+e),r=s("#"+e+"_bg"),a.length<1){var i=['<div id="'+e+'" class="bd_weixin_popup">','<div class="bd_weixin_popup_head">',"<span>分享到微信朋友圈</span>",'<a href="#" onclick="return false;" class="bd_weixin_popup_close">&times;</a>',"</div>",'<div id="'+e+'_qr" class="bd_weixin_popup_main"></div>','<div class="bd_weixin_popup_foot">打开微信，点击底部的“发现”，<br>使用“扫一扫”即可将网页分享至朋友圈。</div>',"</div>"].join("");r=s('<iframe id="bdshare_weixin_qrcode_dialog_bg" class="bd_weixin_popup_bg"></iframe>').appendTo("body"),(a=s(i).appendTo("body")).find(".bd_weixin_popup_close").click(l),s("body").on("keydown",function(i){27==i.keyCode&&l()}),s(window).resize(function(){h()})}d=a.find("#"+e+"_qr"),a.show(),r.show(),h()}(),a.attr("data-url")!=t&&(d.html("正在加载"),t.length,o=t,window._bd_share_main.F.use("component/qrcode",function(i){var n=new i.QRCode(-1,i.QRErrorCorrectLevel.L);n.addData(o),n.make();var e=u(n.modules);s(e).appendTo(d.empty()),_(p),h(),a.attr("data-url",o)}))})}});