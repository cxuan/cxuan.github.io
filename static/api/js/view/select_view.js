window._bd_share_main.F.module("view/select_view",function(e,t,a){var h,_,u,b,p=e("base/tangram").T,n=e("base/class").Class,s=(e("conf/const"),e("view/view_base")),f=function(e){var t="";return t=document.selection?document.selection.createRange().text:document.getSelection(),p.string(t.toString()).trim()},m="getSelection"in document?function(){document.getSelection().removeAllRanges(),b=""}:function(){document.selection.empty(),b=""};t.View=n.create(function(n){var d=this;d._container=null;var s=n.bdStyle||0,i=-1<"|16|24|32|".indexOf("|"+n.bdSize+"|")?n.bdSize:16,o=!1;d._buttonType=0,d.render=function(){var e="bdSharePopup_selectshare"+ +new Date,t=['<iframe frameborder="0" id="'+e+'bg" class="bdselect_share_bg" style="display:none;"></iframe>'].join(""),a=['<div id="'+e+'box" style="display:none;" share-type="selectshare" class="bdselect_share_box">','<div class="selectshare-mod-triangle"><div class="triangle-border"></div><div class="triangle-inset"></div></div>','<div  class="bdselect_share_head" ><span>分享到</span>','<a href="http://www.baidu.com/s?wd='+n.bdText+'&tn=SE_hldp08010_vurs2xrp"',' class="bdselect_share_dialog_search" target="_blank">','<i class="bdselect_share_dialog_search_i"></i>','<span class="bdselect_share_dialog_search_span">百度一下</span></a>','<a class="bdselect_share_dialog_close"></a></div>','<div class="bdselect_share_content" >','<ul class="bdselect_share_list">','<div class="bdselect_share_partners"></div>','<a href="#" class="bds_more"  data-cmd="more"></a>',"</ul>","</div>","</div>"].join("");p("body").insertHTML("beforeEnd",t+a),d._container=h=p("#"+e+"box"),u=h.find(".bdselect_share_list").addClass("bdshare-button-style"+s+"-"+i),_=p("#"+e+"bg"),d._entities.push(h),p(".bdselect_share_dialog_close").click(d.hide)},d.hide=function(e){e||m(),_&&_.hide(),h&&h.hide()},d._init=function(){var e;e=n.bdContainerClass?p("."+n.bdContainerClass):p("body").children(),p("body").on("mouseup",function(a){e.each(function(e,t){t==a.target||p(t).contains(a.target)||!n.bdContainerClass&&a.target==document.body?setTimeout(function(){b=f(),function(){if(n.bdCustomStyle){var e=document.createElement("link");e.href=n.bdCustomStyle,e.rel="styleSheet",e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e)}else window._bd_share_main.F.use("share_style"+s+"_"+i+".css")}(),d.show(a,n)},10):"block"==h.css("display")&&d.hide()})})},d.show=function(t,a){window._bd_share_main.F.use(["component/partners","share_popup.css","select_share.css"],function(e){d._partnerSort=e.partnerSort,o||(function(e,t){t.bdMini;var a=t.bdSelectMiniList||d._partnerSort.slice(0,4),n=[];p.each(a,function(e,t){n[e]='<a href="#" class="bds_'+t+'" data-cmd="'+t+'"></a>'}),u.find(".bdselect_share_partners").html(n.join(""))}(d._container,a),o=!0),function(e,a){var n=function(e,t){var a=e.pageY,n=e.pageX;a+=5,n-=18;var s=h.outerHeight(),i=p(window).scrollTop();(a+s>p("body").height()&&a+s>p(window).height()||a+s>i+p(window).height())&&(a=(a=e.pageY-s-5)<i?i:a);var o=t.bdPopupOffsetLeft,r=t.bdPopupOffsetTop;return(o||r)&&(a+=0|r,n+=0|o),{top:a,left:n}}(e,a);if(b.length<5)d.hide("less");else{p.each([h,_],function(e,t){t.css({top:n.top,left:n.left}).show(),a.bdText=f()});var t=u.find("a").length,s=p(u.find("a")).outerWidth(!0)*t+20,i=parseInt(h.css("max-width"));i&&i<s&&(s=i),h.width(s),h.find(".bdselect_share_head").width(s),_.width(s),_.height(h.height());var o=h.find(".bdselect_share_dialog_search");o.attr("href","http://www.baidu.com/s?wd="+a.bdText+"&tn=SE_hldp08010_vurs2xrp");var r=c(function(){l("http://s.share.baidu.com/select?"+p.ajax.param({log_type:"click",content:encodeURIComponent(a.bdText)}))},100);o.click(r),s<220?h.find(".bdselect_share_dialog_search_span").hide():h.find(".bdselect_share_dialog_search_span").show(),l("http://s.share.baidu.com/select?"+p.ajax.param({log_type:"show",content:encodeURIComponent(a.bdText)}))}}(t,a)})};var r,l=(r={},function(e){var t="bdsharelog__"+(new Date).getTime(),a=r[t]=new Image;a.onload=a.onerror=function(){r[t]=null},a.src=e+"&t="+(new Date).getTime(),a=null}),c=function(a,n,s){var i,o,r,d=null,l=0;s||(s={});var c=function(){l=!1===s.leading?0:new Date,d=null,r=a.apply(i,o),d||(i=o=null)};return function(){var e=new Date;!l&&!1===s.leading&&(l=e);var t=n-(e-l);return i=this,o=arguments,t<=0||n<t?(clearTimeout(d),d=null,l=e,r=a.apply(i,o),d||(i=o=null)):!d&&!1!==s.trailing&&(d=setTimeout(c,t)),r}};d._distory=function(){h.remove(),_.remove()}},s.ViewBase)});