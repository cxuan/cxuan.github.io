<!DOCTYPE html><html lang="zh-Hans"><head><!--[if lt IE 9]><style>body {display: none; background: none !important} </style><meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/"/><![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="c-xuan"><meta name="description" content="在基于数据库的一般应用中，查询的需求总要大于删除和修改。为了避免对于树形结构查询时的“递归”过程，基于Tree的前序遍历设计一种全新的无递归查询、无限分组的左右值编码方案，来保存该树的数据。"><meta property="og:type" content="article"><meta property="og:title" content="树形结构数据存储方案（四）：左右值编码"><meta property="og:url" content="https://c-xuan.com/2017/03/07/tree-table-store4/index.html"><meta property="og:site_name" content="靛青"><meta property="og:description" content="在基于数据库的一般应用中，查询的需求总要大于删除和修改。为了避免对于树形结构查询时的“递归”过程，基于Tree的前序遍历设计一种全新的无递归查询、无限分组的左右值编码方案，来保存该树的数据。"><meta property="og:image" content="https://c-xuan.com/img/posts/tree-table-store4-1.gif"><meta property="og:image" content="https://c-xuan.com/img/posts/tree-table-store4-2.gif"><meta property="og:updated_time" content="2017-03-07T16:12:54.036Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="树形结构数据存储方案（四）：左右值编码"><meta name="twitter:description" content="在基于数据库的一般应用中，查询的需求总要大于删除和修改。为了避免对于树形结构查询时的“递归”过程，基于Tree的前序遍历设计一种全新的无递归查询、无限分组的左右值编码方案，来保存该树的数据。"><meta name="twitter:image" content="https://c-xuan.com/img/posts/tree-table-store4-1.gif"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="alternate" href="/atom.xml" title="靛青" type="application/atom+xml"><link rel="shortcut icon" href="/favicon.png"><link href="/js/others/animate.css" rel="stylesheet"><link href="/js/others/jquery.fancybox.min.css" rel="stylesheet"><script src="/js/others/pace.min.js"></script><link href="/js/others/pace-theme-minimal.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><link href="/js/others/font-awesome.min.css" rel="stylesheet"><title>树形结构数据存储方案（四）：左右值编码 | 靛青</title><script src="/js/others/jquery.min.js"></script><script src="/js/others/clipboard.min.js"></script><script type="text/javascript" src="/js/love.js"></script><script>var yiliaConfig={fancybox:!0,animate:!0,isHome:!1,isPost:!0,isArchive:!1,isTag:!1,isCategory:!1,fancybox_js:"/js/others/jquery.fancybox.min.js",scrollreveal:"/js/others/scrollreveal.min.js",search:!0,jquery_ui:[!0,"/js/others/jquery-ui.min.js","/js/others/jquery-ui.min.css"],rootUrl:"/"}</script><script>var isIgnoreHost=!1;if(window&&window.location&&window.location.host){var isIgnoreHostList="localhost/127.0.0.1",hostArray=isIgnoreHostList.split("/");for(x in hostArray)if(isIgnoreHost=0===window.location.host.indexOf(hostArray[x]))break}var _hmt=_hmt||[];isIgnoreHost||(function(){var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?04b5ef87eb2ec9589e8227fcc877686b";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(t,o)}(),function(){var t=document.createElement("script"),o=window.location.protocol.split(":")[0];t.src="https"===o?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}())</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111421027-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-111421027-1")</script></head><body><div id="container"><div class="left-col"><form id="search-form"> <input type="text" id="local-search-input" name="q" placeholder="搜索本站..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false"></form><div id="local-search-result"></div><p class="no-result">No results found<i class="fa fa-spinner fa-pulse"></i></p><div class="intrude-less"><header id="header" class="inner"> <a href="/" class="profilepic"><img src="/img/cxuan.png" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/" data-hover="靛青">靛青</a></h1></hgroup><p class="header-subtitle">青，取之于藍而青于藍。</p><div id="switch-btn" class="switch-btn"><div class="icon"><div class="icon-ctn"><div class="icon-wrap icon-house" data-idx="0"><div class="birdhouse"></div><div class="birdhouse_holes"></div></div><div class="icon-wrap icon-ribbon hide" data-idx="1"><div class="ribbon"></div></div><div class="icon-wrap icon-link hide" data-idx="2"><div class="loopback_l"></div><div class="loopback_r"></div></div><div class="icon-wrap icon-me hide" data-idx="3"><div class="user"></div><div class="shoulder"></div></div></div></div><div class="tips-box hide"><div class="tips-arrow"></div><ul class="tips-inner"><li>菜单</li><li>标签</li><li>友情链接</li><li>关于我</li></ul></div></div><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="/" data-hover="主页">主页</a></li><li><a href="/archives/" data-hover="所有文章">所有文章</a></li><li><a href="/tags/" data-hover="标签云">标签云</a></li><li><a href="/whis/" data-hover="折腾史">折腾史</a></li><li><a href="/about/" data-hover="关于我">关于我</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" href="mailto:c-xuan@foxmail.com" title="Email"></a><a class="fa 新浪微博" href="http://weibo.com/u/1794820305" title="新浪微博"></a> <a class="fa GitHub" href="https://github.com/cxuan" title="GitHub"><svg height="37" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="37" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a><a class="fa 简书" href="http://www.jianshu.com/users/2e80e903099c/latest_articles" title="简书"></a><a class="fa RSS" href="/atom.xml" title="RSS"></a></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id="js-tagcloud"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Atom/">Atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BI/">BI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BigData/">BigData</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ETL/">ETL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flask/">Flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hbase/">Hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/">Hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IT资讯/">IT资讯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JScript/">JScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MSBI/">MSBI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ORACLE/">ORACLE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PDI/">PDI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Play-Framework/">Play Framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostgreSQL/">PostgreSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL-Server/">SQL Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSIS/">SSIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/">Test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/atom/">atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmd/">cmd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kettle/">kettle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pentaho/">pentaho</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端编程/">前端编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原创/">原创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源/">开源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学/">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据仓库/">数据仓库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/物化视图/">物化视图</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生活趣记/">生活趣记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/知识管理/">知识管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/维度建模/">维度建模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻译/">翻译</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/视觉图片/">视觉图片</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机基原理/">计算机基原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计/">设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/转载/">转载</a></li></ul></div></section><section class="switch-part switch-part3"><div id="js-friends"> <a class="main-nav-link switch-friends-link" href="http://opiece.me/">Chillax&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="https://ask.hellobi.com/blog/biwork">BIWORK</a> <a class="main-nav-link switch-friends-link" href="http://blog.iwangyu.cn/">Wang Yu&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="http://www.domeyi.com/">小忆</a> <a class="main-nav-link switch-friends-link" href="https://www.sfantree.com/">水番林</a> <a class="main-nav-link switch-friends-link" href="http://www.netcan666.com/">Netcan</a> <a class="main-nav-link switch-friends-link" href="http://www.ykksmile.top/">Ykk</a> <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a> <a class="main-nav-link switch-friends-link" href="http://luuman.github.io/">世平阜康</a> <a class="main-nav-link switch-friends-link" href="http://www.blog67.cn/">67&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="http://hubojing.github.io/">胡博靖</a> <a class="main-nav-link switch-friends-link" href="https://deserts.io">Deserts</a> <a class="main-nav-link switch-friends-link" href="https://www.liyebk.com">李野博客</a> <a class="main-nav-link switch-friends-link" href="https://xlesun.com/">Lesun&#39;s Blog</a> <a class="main-nav-link switch-friends-link" href="http://blog.codinglabs.org/">CodingLabs</a></div></section><section class="switch-part switch-part4"><div id="js-aboutme">专注于DW&amp;BI</div></section></div></div></header></div><footer id="left-col-footer"><div class="footer-center"><i class="fa fa-copyright"></i> 2016-2019 c-xuan</div></footer></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">c-xuan</a></h1></div><div class="intrude-less"><header id="header" class="inner"> <a href="/" class="profilepic" width="20%"><img src="/img/cxuan.png" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/" title="回到主页">靛青</a></h1></hgroup><p class="header-subtitle">青，取之于藍而青于藍。</p><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/whis/">折腾史</a></li><li><a href="/about/">关于我</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" target="_blank" href="mailto:c-xuan@foxmail.com" title="Email"></a><a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/1794820305" title="新浪微博"></a> <a class="fa GitHub" target="_blank" href="https://github.com/cxuan" title="GitHub"><svg height="37" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="37" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a><a class="fa 简书" target="_blank" href="http://www.jianshu.com/users/2e80e903099c/latest_articles" title="简书"></a><a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a></ul></nav></header></div><link class="menu-list" tags="标签" friends="友情链接" about="关于我"></nav><div class="body-wrap"><article id="post-tree-table-store4" class="article article-type-post animated pulse" itemscope itemprop="blogPost"><div class="article-meta"> <a href="/2017/03/07/tree-table-store4/" class="article-date"><time datetime="2017-03-07T15:34:08.000Z" itemprop="datePublished">2017-03-07</time></a></div><div class="article-inner"> <input type="hidden" class="isFancy"><header class="article-header"><h1 class="article-title" itemprop="name"> 树形结构数据存储方案（四）：左右值编码</h1></header><div class="article-info article-info-post"><div class="article-category tagcloud"> <a class="article-category-link" href="/categories/码路刺客/">码路刺客</a></div><div class="article-tag tagcloud"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/转载/">转载</a></li></ul></div><div style="font-size:.9rem;color:#696969;line-height:2">　　<i class="fa fa-pencil-square-o" aria-hidden="true"></i> 本文字数<span class="post-count">1,669</span> |<i class="fa fa-clock-o" aria-hidden="true"></i> 阅读时长约<span class="post-count">8</span>分钟</div><div class="clearfix"></div></div><div class="article-entry" itemprop="articleBody"><p>在基于数据库的一般应用中，查询的需求总要大于删除和修改。为了避免对于树形结构查询时的“递归”过程，基于Tree的前序遍历设计一种全新的无递归查询、无限分组的左右值编码方案，来保存该树的数据。</p><center><img src="/img/posts/tree-table-store4-1.gif"></center><a id="more"></a><p>第一次看见这种表结构，相信大部分人都不清楚左值（Lft）和右值（Rgt）是如何计算出来的，而且这种表设计似乎并没有保存父子节点的继承关系。但当你用手指指着表中的数字从1数到18，你应该会发现点什么吧。对，你手指移动的顺序就是对这棵树进行前序遍历的顺序，如下图所示。当我们从根节点Food左侧开始，标记为1，并沿前序遍历的方向，依次在遍历的路径上标注数字，最后我们回到了根节点Food，并在右边写上了18。</p><center><img src="/img/posts/tree-table-store4-2.gif"></center><p>依据此设计，我们可以推断出所有左值大于2，并且右值小于11的节点都是Fruit的后续节点，整棵树的结构通过左值和右值存储了下来。然而，这还不够，我们的目的是能够对树进行CRUD操作，即需要构造出与之配套的相关算法。按照深度优先，由左到右的原则遍历整个树，从1开始给每个节点标注上left值和right值，并将这两个值存入对应的name之中。</p><p>如何查询？</p><p>1、获取某个节点下的所有子孙节点，以Fruit为例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> Lft &gt; <span class="number">2</span> <span class="keyword">AND</span> Lft &lt; <span class="number">11</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> Lft <span class="keyword">ASC</span></div></pre></td></tr></table></figure><p>2、获取子孙节点总数<br>子孙总数 = (右值–左值–1)/2，以Fruit为例，其子孙总数为：(11–2–1)/2 = 4</p><p>3、 获取节点在树中所处的层数，以Fruit为例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> Lft &lt;= <span class="number">2</span> <span class="keyword">AND</span> Rgt &gt;=<span class="number">11</span></div></pre></td></tr></table></figure><p>4、 获取当前节点所在路径，以Fruit为例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> Lft &lt;= <span class="number">2</span> <span class="keyword">AND</span> Rgt &gt;=<span class="number">11</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> Lft <span class="keyword">ASC</span></div></pre></td></tr></table></figure><p>在日常的处理中我们经常还会遇到的需要获取某一个节点的直属上级、同级、直属下级。为了更好的描述层级关系，我们可以为Tree建立一个视图，添加一个层次列，该列数值可以编写一个自定义函数来计算：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> <span class="string">`CountLayer`</span>(<span class="string">`_node_id`</span> <span class="built_in">int</span>)</div><div class="line"><span class="keyword">RETURNS</span> <span class="built_in">int</span>(<span class="number">11</span>)</div><div class="line"><span class="keyword">BEGIN</span></div><div class="line"><span class="keyword">DECLARE</span> _result <span class="built_in">INT</span>;</div><div class="line"><span class="keyword">DECLARE</span> _lft <span class="built_in">INT</span>;</div><div class="line"><span class="keyword">DECLARE</span> _rgt <span class="built_in">INT</span>;</div><div class="line">IF EXISTS(<span class="keyword">SELECT</span> Node_id <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> Node_id = _node_id)</div><div class="line"><span class="keyword">THEN</span></div><div class="line"><span class="keyword">SELECT</span> Lft,Rgt <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> Node_id = _node_id <span class="keyword">INTO</span> _lft,_rgt;</div><div class="line"><span class="keyword">SET</span> _result = (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> Lft &lt;= _lft <span class="keyword">AND</span> Rgt &gt;= _rgt); </div><div class="line">RETURN _result;</div><div class="line">ELSE</div><div class="line">RETURN 0;</div><div class="line"><span class="keyword">END</span> <span class="keyword">IF</span>;</div><div class="line"><span class="keyword">END</span>;</div></pre></td></tr></table></figure><p>在添加完函数以后，我们创建一个a视图，添加新的层次列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> <span class="string">`NewView`</span><span class="keyword">AS</span> </div><div class="line"><span class="keyword">SELECT</span> Node_id, <span class="keyword">Name</span>, Lft, Rgt, CountLayer(Node_id) <span class="keyword">AS</span> Layer <span class="keyword">FROM</span> Tree <span class="keyword">ORDER</span> <span class="keyword">BY</span> Lft ;</div></pre></td></tr></table></figure><p>5、 获取当前节点父节点,以Fruit为例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> treeview <span class="keyword">WHERE</span> Lft &lt;= <span class="number">2</span> <span class="keyword">AND</span> Rgt &gt;=<span class="number">11</span> <span class="keyword">AND</span> Layer=<span class="number">1</span></div></pre></td></tr></table></figure><p>6、 获取所有直属子节点，以Fruit为例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> treeview <span class="keyword">WHERE</span> Lft <span class="keyword">BETWEEN</span> <span class="number">2</span> <span class="keyword">AND</span> <span class="number">11</span> <span class="keyword">AND</span> Layer=<span class="number">3</span></div></pre></td></tr></table></figure><p>7、 获取所有兄弟节点，以Fruit为例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> treeview <span class="keyword">WHERE</span> Rgt &gt; <span class="number">11</span> <span class="keyword">AND</span> Rgt &lt; (<span class="keyword">SELECT</span> Rgt <span class="keyword">FROM</span> treeview <span class="keyword">WHERE</span> Lft &lt;= <span class="number">2</span> <span class="keyword">AND</span> Rgt &gt;=<span class="number">11</span> <span class="keyword">AND</span> Layer=<span class="number">1</span>) <span class="keyword">AND</span> Layer=<span class="number">2</span></div></pre></td></tr></table></figure><p>8、 返回所有叶子节点</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> Rgt = Lft + <span class="number">1</span></div></pre></td></tr></table></figure><p><strong>如何创建树？如何新增数据？</strong></p><p>上面已经介绍了如何检索结果，那么如何才能增加新的节点呢？Nested set 最重要是一定要有一个根节点作为所有节点的起点，而且通常这个节点是不被使用的。为了便于控制查询级别，在建表的时候建议添加parent_id配合之联结列表方式一起使用。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">`Tree`</span> (</div><div class="line"><span class="string">`node_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</div><div class="line"><span class="string">`parent_id`</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</div><div class="line"><span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line"><span class="string">`lft`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</div><div class="line"><span class="string">`rgt`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span>,</div><div class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`node_id`</span>),</div><div class="line"><span class="keyword">KEY</span> <span class="string">`idx_left_right`</span> (<span class="string">`lft`</span>,<span class="string">`rgt`</span>)</div><div class="line">) <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</div></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`Tree`</span> (parent_id,<span class="keyword">name</span>,lft,rgt) <span class="keyword">VALUES</span> ( <span class="number">0</span>,<span class="string">'Food'</span>,<span class="number">1</span>,<span class="number">2</span>)</div></pre></td></tr></table></figure><p>添加子节点（子节点起始处），以在Food下添加子节点Fruit为例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">LOCK</span> <span class="keyword">TABLE</span> Tree WRITE;</div><div class="line"><span class="keyword">SELECT</span> @parent_id := node_id, @myLeft := lft <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Food'</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> rgt = rgt + <span class="number">2</span> <span class="keyword">WHERE</span> rgt &gt; @myLeft;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft + <span class="number">2</span> <span class="keyword">WHERE</span> lft &gt; @myLeft;</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Tree(parent_id, <span class="keyword">name</span>, lft, rgt) <span class="keyword">VALUES</span>(@parent_id, <span class="string">'Fruit'</span>, @myLeft + <span class="number">1</span>, @myLeft + <span class="number">2</span>);</div><div class="line"><span class="keyword">UNLOCK</span> <span class="keyword">TABLES</span>;</div></pre></td></tr></table></figure><p>如需在末尾追加就需要以下方式进行（以在Red下添加Apple为例）：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">LOCK</span> <span class="keyword">TABLE</span> Tree WRITE;</div><div class="line"><span class="keyword">SELECT</span> @parent_id := node_id , @myRight := rgt <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Red'</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> rgt = rgt + <span class="number">2</span> <span class="keyword">WHERE</span> rgt &gt;= @myRight;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft + <span class="number">2</span> <span class="keyword">WHERE</span> lft &gt; @myRight;</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Tree(parent_id, <span class="keyword">name</span>, lft, rgt) <span class="keyword">VALUES</span>(@parent_id, <span class="string">'Apple'</span>, @myRight, @myRight + <span class="number">1</span>);</div><div class="line"><span class="keyword">UNLOCK</span> <span class="keyword">TABLES</span>;</div></pre></td></tr></table></figure><p>在节点A后面添加同级节点（以在Yellow后面添加Green为例）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">LOCK</span> <span class="keyword">TABLE</span> Tree WRITE;</div><div class="line"><span class="keyword">SELECT</span> @parent_id := parent_id , @myRight := rgt <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Yellow'</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> rgt = rgt + <span class="number">2</span> <span class="keyword">WHERE</span> rgt &gt; @myRight;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft + <span class="number">2</span> <span class="keyword">WHERE</span> lft &gt; @myRight;</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Tree(parent_id, <span class="keyword">name</span>, lft, rgt) <span class="keyword">VALUES</span>(@parent_id, <span class="string">'Green'</span>, @myRight+<span class="number">1</span>, @myRight+<span class="number">2</span>);</div><div class="line"><span class="keyword">UNLOCK</span> <span class="keyword">TABLES</span>;</div></pre></td></tr></table></figure><p>以上讨论的添加节点指的都是添加末端节点，即插入的这个节点不是当前已存在节点的父节点。如果需要插入非末端节点要怎么办呢？<br>这个过程可以将流程分为2步，首先新增节点，接下里再将需要的节点移到新增的节点下级。节点移动方法(以将Apple移到Yellow中为例)：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">LOCK</span> <span class="keyword">TABLE</span> Tree WRITE;</div><div class="line"><span class="keyword">SELECT</span> @nodeId := node_id , @myLeft := lft , @myRight := rgt <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Apple'</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft - (@myRight - @myLeft) - <span class="number">1</span> <span class="keyword">WHERE</span> lft &gt; @myRight;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> rgt = rgt - (@myRight - @myLeft) - <span class="number">1</span> <span class="keyword">WHERE</span> rgt &gt; @myRight;</div><div class="line"><span class="keyword">SELECT</span> @parent_id := node_id , @<span class="keyword">Left</span> := lft , @<span class="keyword">Right</span> := rgt <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Yellow'</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft + (@myRight - @myLeft) + <span class="number">1</span> <span class="keyword">WHERE</span> lft &gt; @<span class="keyword">Left</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> rgt = rgt + (@myRight - @myLeft) + <span class="number">1</span> <span class="keyword">WHERE</span> lft &gt; @<span class="keyword">Left</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> parent_id = @parent_id <span class="keyword">WHERE</span> <span class="keyword">name</span> = node_id = @nodeId;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = @<span class="keyword">Left</span> + lft - @myLeft + <span class="number">1</span>, rgt = @<span class="keyword">Left</span> + lft - @myLeft + <span class="number">1</span> + (@myRight - @myLeft) <span class="keyword">WHERE</span> lft &gt;= @myLeft <span class="keyword">AND</span> rgt &lt;= @myRight;</div><div class="line"><span class="keyword">UNLOCK</span> <span class="keyword">TABLES</span>;</div></pre></td></tr></table></figure><p><strong>删除节点（包含子节点）</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">LOCK</span> <span class="keyword">TABLE</span> Tree WRITE;</div><div class="line"><span class="keyword">SELECT</span> @myLeft := lft , @myRight := rgt <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Apple'</span>;</div><div class="line"><span class="keyword">DELETE</span> Tree <span class="keyword">WHERE</span> lft &gt;= @myLeft <span class="keyword">AND</span> rgt &lt;= @myRight;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft - (@myRight - @myLeft) - <span class="number">1</span> <span class="keyword">WHERE</span> lft &gt; @myRight;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> rgt = rgt - (@myRight - @myLeft) - <span class="number">1</span> <span class="keyword">WHERE</span> rgt &gt; @myRight;</div><div class="line"><span class="keyword">UNLOCK</span> <span class="keyword">TABLES</span>;</div></pre></td></tr></table></figure><p>如果需要只删除该节点，子节点自动上移一级如何处理？</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">LOCK</span> <span class="keyword">TABLE</span> Tree WRITE;</div><div class="line"><span class="keyword">SELECT</span> @parent_id := parent_id , @node_id :=node_id , @myLeft := lft , @myRight := rgt <span class="keyword">FROM</span> Tree <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Red'</span>;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> parent_id = @parent_id <span class="keyword">WHERE</span> parent_id = @node_id</div><div class="line"><span class="keyword">DELETE</span> Tree <span class="keyword">WHERE</span> lft = @myLeft;</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft - <span class="number">1</span>,rgt = rgt<span class="number">-1</span> <span class="keyword">Where</span> lft &gt; @myLeft <span class="keyword">AND</span> @rgt &lt; @myRight</div><div class="line"><span class="keyword">UPDATE</span> Tree <span class="keyword">SET</span> lft = lft - <span class="number">2</span>,rgt = rgt<span class="number">-2</span> <span class="keyword">Where</span> lft &gt; @rgt &gt; @myRight</div><div class="line"><span class="keyword">UNLOCK</span> <span class="keyword">TABLES</span>;</div></pre></td></tr></table></figure><p>以上为Nested Set的CURD操作，具体在使用时建议结合事务和存储过程一起使用。本方案的优点时查询非常的方便，缺点就是每次插入删除数据涉及到的更新内容太多，如果树非常大，插入一条数据可能花很长的时间。</p><p>参考链接：<br> ● <a href="https://www.sitepoint.com/hierarchical-data-database/" target="_blank" rel="external">https://www.sitepoint.com/hierarchical-data-database/</a><br> ● <a href="https://packagist.org/search/?q=Nested+Set" target="_blank" rel="external">https://packagist.org/search/?q=Nested+Set</a></p><p>转自<a href="https://www.biaodianfu.com/the-nested-set-model.html" target="_blank" rel="external">https://www.biaodianfu.com/the-nested-set-model.html</a></p><p>作者：标点符</p></div></div><div class="copyright"><p><span>本文标题:</span><a href="/2017/03/07/tree-table-store4/">树形结构数据存储方案（四）：左右值编码</a></p><p><span>文章作者:</span><a href="/" title="回到主页">c-xuan</a></p><p><span>发布时间:</span>2017-03-07, 23:34:08</p><p><span>最后更新:</span>2017-03-08, 00:12:54</p><p> <span>原始链接:</span><a class="post-url" href="/2017/03/07/tree-table-store4/" title="树形结构数据存储方案（四）：左右值编码">https://c-xuan.com/2017/03/07/tree-table-store4/</a><span class="copy-path" data-clipboard-text="原文: https://c-xuan.com/2017/03/07/tree-table-store4/　　作者: c-xuan" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span><script>var clipboard=new Clipboard(".copy-path")</script></p><p> <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。</p></div><nav id="article-nav"><div id="article-nav-newer" class="article-nav-title"> <a href="/2017/03/07/tree-table-store5/">树形结构数据存储方案（五）：区间嵌套</a></div><div id="article-nav-older" class="article-nav-title"> <a href="/2017/03/06/tree-table-store3/">树形结构数据存储方案（三）：闭包表</a></div></nav><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏"></a> <span class="donate_txt">↑<br> 有所帮助？赏包辣条！</span><br></div><div id="donate_guide" class="donate_bar center hidden animated bounceIn"> <img src="/img/Alipay.png" alt="支付宝打赏"> <img src="/img/WeChatpay.png" alt="微信打赏"></div><script type="text/javascript">document.getElementById("btn_donate").onclick=function(){$("#donate_board").addClass("hidden"),$("#donate_guide").removeClass("hidden")}</script></div></article><div id="toc" class="toc-article"> <strong class="toc-title">文章目录</strong></div><style>.left-col .switch-area,.left-col .switch-btn{display:none}.toc-level-4 i,.toc-level-4 ol{display:none!important}</style> <input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录"><script>yiliaConfig.toc=["隐藏目录","显示目录",!0]</script><div class="share"><script>with(window._bd_share_config={common:{bdSnsKey:{},bdText:"",bdMini:"2",bdMiniList:!1,bdPic:"",bdStyle:"0",bdSize:"16"},slide:{type:"slide",bdImg:"6",bdPos:"right",bdTop:"100"},image:{viewList:["qzone","tsina","weixin","youdao","fbook","twi"],viewText:"分享到：",viewSize:"16"},selectShare:{bdContainerClass:null,bdSelectMiniList:["qzone","tsina","weixin","youdao","fbook","twi"]}},document)(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)</script></div><section id="comments" class="valine" style="width:85%;margin:0 auto;background:rgba(255,255,255,.7);padding:1% 1% 0 1%;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px"><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var notify=!1,verify=!1;if(new Valine({av:AV,el:"#vcomment",notify:notify,verify:verify,app_id:"wKQ5QBjSGMEviU0fVawpBJo0-gzGzoHsz",app_key:"1zPWBxCFNb0UPr85TMeCNLOK",placeholder:"说点什么吧... ps:昵称/邮箱/网址都可以选填哦",avatar:"wavatar",avatar_cdn:"https://sdn.geekzu.org/avatar/",pageSize:20,meta:["nick","mail","link"]}),window.location.hash)var checkExist=setInterval(function(){$(window.location.hash).length&&($("html, body").animate({scrollTop:$(window.location.hash).offset().top-90},1e3),clearInterval(checkExist))},100)</script></section><div class="scroll" id="post-nav-button"><a href="/2017/03/07/tree-table-store5/" title="上一篇: 树形结构数据存储方案（五）：区间嵌套"><i class="fa fa-angle-left"></i></a><a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a><a href="/2017/03/06/tree-table-store3/" title="下一篇: 树形结构数据存储方案（三）：闭包表"><i class="fa fa-angle-right"></i></a></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/03/27/20190327001_pdi_case/">PDI设计转换任务</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/26/20190326001_python_datetime/">Python日期时间操作总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/13/20190313001_python_dict/">【Python 3 基础】字典dict创建方法及常用操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/05/20190305001_css_parallax_effects/">CSS视差效果设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/21/20190221001_nteract/">类Jupyter notebook编辑器桌面版nteract</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/20/20190220002_atom_atuo_err/">【Atom】autocomplete-python插件报乱码异常问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/20/20190220001_py_list_merge/">Python多个数组合并</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/18/20190218001_hydrogen_venv/">Atom编辑器中使用Hydrogen切换Python虚拟环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/14/20190214001_product_card/">【Web前端】11个使用CSS制作产品展示卡片样例</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/07/20190207001_css_water_effects/">CSS制作水滴效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/15/20190115001_python_db_select_to_df/">Python连接数据库将查询结果转换为DataFrame(列名和表字段一致)</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/04/20190104001_graph_sql/">SQL如何实现查找节点依赖</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/23/20181223001_flask_intranet_visit/">Flask服务本机之外不能访问</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/21/20181221001_atom_aligner/">Atom插件aligner冒号(:)对齐的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/24/20181124001_css_fire/">Html中使用CSS制作火焰燃烧动画</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/18/20181118001_403_pages/">有趣的403页面设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/14/20181114001_404_pages/">有趣的404页面设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/13/20180813001_py_clousure/">理解Python函数闭包</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/26/20180726001_aqua_hive_go/">Aqua Data Studio 执行HiveSql的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/24/20180724001_hive_date_trans/">【Hive】日期从整形转为Date类型</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/02/20180602001_jscript/">有用的JScript代码整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/26/20180126001/">【Python 3 基础】循环</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/24/20180124001/">CentOS Hbase-1.2.0 安装配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/20/20180120001/">CentOS上zookeeper集群模式安装配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/10/20171210001/">Markdown使用table标签创建表格的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/28/20171128001/">【cmd】IF ELSE 复制(copy)文件问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/19/20171119001/">【ORACLE】导致物化视图快速刷新变慢的原因和解决</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/15/20170815001/">【ORACLE】常用物化视图相关元数据查询语句</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/13/20170813001/">【ORACLE】物化视图相关元数据视图字段说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/13/20170713001/">【ORACLE】物化视图快速刷新限制条件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/07/tree-table-store5/">树形结构数据存储方案（五）：区间嵌套</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/07/tree-table-store4/">树形结构数据存储方案（四）：左右值编码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/06/tree-table-store3/">树形结构数据存储方案（三）：闭包表</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/06/tree-table-store2/">树形结构数据存储方案（二）： 物化路径</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/06/tree-table-store1/">树型结构数据存储方案（一）：邻接列表模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/05/KimballDimModing/">Kimball维度建模技术总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/wide-table-thinking/">宽表和窄表的建设该如何选择？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/02/SQLAddColumnNote/">【SQL Server】编辑、修改字段说明（备注）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/BenifitOfWritingBlog/">从事技术，坚持写博客的好处？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/HardSayGoodby/">再见Solo，谢谢!</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/29/JS-BuildBaseClassLib/">JavaScript :零基础打造自己的类库</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/WhyDifficultOnETLJob/">为什么ETL任务困难</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/DecisionThoughtOnBigdata/">从大数据负责人招聘看决策思维</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/08/TimeForPKM/">是时候管理你的知识了</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/21/NoWeChatBefore/">那些年，我们没有微信</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/21/PlayFrameworkInit2/">Play Framework 2.5 环境搭建与新建项目（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/20/PlayFrameworkInit/">Play Framework 2.5 环境搭建与新建项目（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/17/PCProblemRightKeyItem/">电脑右键菜单中没有新建和在此处打开命令行选项的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/12/ConstraintNameUniquenessProblem/">【PowerDesigner】Constraint name uniqueness问题及处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/21RulesForDataWarehousing/">数据仓库设计的7个步骤，7个禁忌和7种思路</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/SSISCodePageProblem/">SSIS中代码页(Code Page)问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/26/DataWarehouseSchemeCompare/">深入对比数据仓库模式：Kimball vs Inmon</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Datawarehouse-10Dimension-principle/">数据仓库维度建模10大基本原则</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/20/MarkDown教程/">Markdown教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/29/Foumula-TOP10/">改变世界的公式TOP10,最后一个一看就蒙圈了</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/13/SSIS-GeneralAttribures/">【SSIS】几个通用属性</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/13/SQL-GroupByAndGroupingSets/">【T-SQL】group by 和grouping sets</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/05/BuildBusinessOrientedBigDataCloudPlatform/">放开那程序猿！构建业务导向的大数据云平台</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/05/RealEstateBISolutionCaseShare/">房地产行业商业智能解决方案分享</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/27/SQL-SERVER-RPC-FUNCTION-CALL/">【SQL SERVER】OPENQUERY远程函数引用及参数传值问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/26/Linked-Server-RPC/">【SQL SERVER】链接数据库“无法启动分布式事务”的问题及解决</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/25/30-Astonishing-Nature-Places-on-Earth/">令人惊叹的30个自然奇观</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/22/JS-AddIn-PPTSlideEffect/">JS插件:类似PPT翻页过渡动画效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/21/SSIS-Precedence-Constraint/">【SSIS】中Precedence Constraint 优先约束的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/16/SSIS-XMLTask-ProcessArrays/">【SSIS】中Foreach循环容器处理XML数据</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/15/SSIS-Web-Service/">【SSIS】使用 Web Service 以及 解析XML 数据</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/06/SSIS-Template-For-SSISPackage/">【SSIS】利用SSIS模板快速开发SSIS Package</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/06/The-Art-of-Computer-Programming/">比尔·盖茨：如果你看完了这些极其难懂的书，请给我投简历！</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/26/codepen-top-10/">CodePen上碉堡的前端设计和代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/26/Delete-duplicate-rows-with-no-primary-key/">如何在没有主键的SQL Server表里删除重复行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/CSS3-transform-style-3D-Cool/">学习制作CSS3 3D旋转透视效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/SQL-Server-2014-SSDT-Install/">SQL Server 2014的BI开发工具SSDT(以前的BIDS)安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/07/SSIS-Pivot/">【SSIS】进行列转行格式的转换</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/27/AppleTV-Poster-Like/">用CSS3 & jQuery创建apple TV海报视差效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/17JqueryTips/">17个jQuery实用技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/IconForEveryday/">365cons：每天一枚图标，可免费下载</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/YouDaoNoteMarkdownSupport/">有道笔记支持Markdown啦</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/19/CSS-For-Flip-Effect/">用CSS创建翻转动画</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/17/Web-Cloud-Effect/">Web蓝天白云的极致体验</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/15/CSS-3D-Cloud/">怎样用CSS做出3D效果的云</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/13/SQL-Merge/">SQL强大的关键字Merge</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/12/AlphaGo/">关于李世石大战AlphaGo，看这一篇就足够了</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/09/Paper-Folding/">18种折纸，一起来怀念小时候吧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/08/pentaho6-install/">Pentaho 6.0 安装与启动教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/03/hello-world/">Hello World</a></li></ul><script></script></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left"> <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span></div><div class="footer-right"> Based on <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a> Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a></div></div><div class="visit"><span id="busuanzi_container_site_pv" style="display:none"><span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span></span></span> <span>|</span><span id="busuanzi_container_page_pv" style="display:none"><span id="page-visit" title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span></span></span></div></div></footer><script>var now=new Date;function createtime(){var n=new Date("2016-08-20 04:18:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="运行"+dnum+"天",document.getElementById("times").innerHTML=hnum+"时"+mnum+"分"+snum+"秒"}setInterval("createtime()",250)</script></div><script data-main="/js/main.js" src="/js/others/require.min.js"></script><script>$(document).ready(function(){if(-1<window.navigator.userAgent.indexOf("iPad")||"none"===$(".left-col").css("display")){var a=["#9db3f4","#414141","#e5a859","#f5dfc6","#c084a0","#847e72","#cd8390","#996731"],c=Math.ceil(Math.random()*(a.length-1));$("body").css({"background-color":a[c],"background-size":"cover"})}else{var e="url(/background/bg-x.jpg)".replace(/x/gi,Math.ceil(2*Math.random()));$("body").css({background:e,"background-attachment":"fixed","background-size":"cover"})}})</script><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-111421027-1","auto"),ga("send","pageview")</script><div class="scroll" id="scroll"><a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a><a href="#comments" onclick="load$hide()" title="查看评论"><i class="fa fa-comments-o"></i></a><a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a></div><script>var oOpenInNew={archives:".archive-article-title",miniArchives:"a.post-list-link",friends:"#js-friends a",socail:".social a"};for(var x in oOpenInNew)$(oOpenInNew[x]).attr("target","_blank")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/izumi.model.json"},display:{superSample:1,width:150,height:300,position:"right",hOffset:0,vOffset:-20},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.8},log:!1})</script></body></html>